<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Atacado Kilombo 93</title>
    <link rel="icon" type="image/png" href="images/Favicon.png">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-green: #28a745;
            --secondary-green: #66BB6A;
            --light-green: #81C784;
            --accent-green: #20c997;
            --dark-bg: #1a1a1a;
            --medium-bg: #2d2d2d;
            --light-bg: rgba(255, 255, 255, 0.08);
            --border-color: rgba(255, 255, 255, 0.1);
            --text-primary: #ffffff;
            --text-secondary: #cccccc;
            --warning-color: #ffc107;
            --success-color: #28a745;
            --error-color: #dc3545;
        }

        /* Light theme variables */
        body.light-theme {
            --dark-bg: #f8f9fa;
            --medium-bg: #ffffff;
            --light-bg: rgba(0, 0, 0, 0.05);
            --border-color: rgba(0, 0, 0, 0.1);
            --text-primary: #333333;
            --text-secondary: #666666;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--dark-bg) 0%, var(--medium-bg) 100%);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            transition: all 0.3s ease;
        }

        /* Loading Spinner */
        .loading-spinner {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 9999;
            justify-content: center;
            align-items: center;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid var(--border-color);
            border-top: 5px solid var(--primary-green);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Theme Toggle */
        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--light-bg);
            border: 1px solid var(--border-color);
            border-radius: 50px;
            padding: 10px 15px;
            cursor: pointer;
            z-index: 1000;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .theme-toggle:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        /* Cart Summary - Floating Button */
        .cart-summary {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: linear-gradient(135deg, var(--primary-green), var(--secondary-green));
            color: white;
            padding: 15px 20px;
            border-radius: 50px;
            box-shadow: 0 4px 20px rgba(40, 167, 69, 0.3);
            z-index: 999;
            min-width: 200px;
            backdrop-filter: blur(10px);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .cart-summary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(40, 167, 69, 0.4);
        }

        .cart-total {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .cart-count {
            background: rgba(255, 255, 255, 0.2);
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.9em;
            display: inline-block;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            padding-bottom: 120px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px 0;
            background: var(--light-bg);
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .logo-image {
            height: 80px;
            width: auto;
            margin: 0 auto 20px auto;
            display: block;
            transition: all 0.3s ease;
        }

        .logo-dark {
            display: none;
        }

        .logo-light {
            display: block;
        }

        body.light-theme .logo-dark {
            display: none;
        }

        body.light-theme .logo-light {
            display: block;
        }

        body.dark-theme .logo-dark {
            display: block;
        }

        body.dark-theme .logo-light {
            display: none;
        }

        .whatsapp-text {
            margin-bottom: 15px;
            color: var(--text-secondary);
            font-size: 0.95em;
            line-height: 1.5;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .whatsapp-link {
            display: inline-block;
            background: linear-gradient(135deg, #25D366, #128C7E);
            color: white;
            padding: 12px 25px;
            border-radius: 25px;
            text-decoration: none;
            margin-top: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(37, 211, 102, 0.3);
        }

        .whatsapp-link:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(37, 211, 102, 0.4);
        }

        /* Existing Customer Section */
        .existing-customer {
            background: linear-gradient(135deg, var(--primary-green) 0%, var(--accent-green) 100%);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .existing-customer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="2" fill="rgba(255,255,255,0.1)"/></svg>') repeat;
            opacity: 0.3;
        }

        .existing-customer h2 {
            font-size: 1.8em;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            position: relative;
            z-index: 1;
        }

        .existing-customer p {
            margin-bottom: 20px;
            font-size: 1.1em;
            position: relative;
            z-index: 1;
        }

        .existing-customer-form {
            display: flex;
            gap: 15px;
            align-items: end;
            flex-wrap: wrap;
            position: relative;
            z-index: 1;
        }

        .existing-customer-form .form-group {
            flex: 1;
            min-width: 250px;
        }

        .existing-customer-form label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: white;
        }

        .existing-customer-form input {
            width: 100%;
            padding: 12px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .existing-customer-form input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .existing-customer-form input:focus {
            outline: none;
            border-color: rgba(255, 255, 255, 0.8);
            background: rgba(255, 255, 255, 0.3);
        }

        .existing-customer-form button {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 150px;
            justify-content: center;
            margin-bottom: 8px;
        }

        .existing-customer-form button:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.8);
            transform: translateY(-2px);
        }

        /* Form Styles */
        .form-section {
            background: var(--light-bg);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid var(--border-color);
            backdrop-filter: blur(10px);
        }

        .form-section h2 {
            color: var(--primary-green);
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            background: var(--medium-bg);
            color: var(--text-primary);
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary-green);
            box-shadow: 0 0 0 3px rgba(40, 167, 69, 0.1);
        }

        /* Products Section */
        .products-section {
            background: var(--light-bg);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid var(--border-color);
            backdrop-filter: blur(10px);
        }

        .products-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .products-header h2 {
            color: var(--primary-green);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .products-controls {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .search-input {
            padding: 10px 15px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            background: var(--medium-bg);
            color: var(--text-primary);
            min-width: 200px;
        }

        .filter-select {
            padding: 10px 15px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            background: var(--medium-bg);
            color: var(--text-primary);
            min-width: 150px;
        }

        .clear-cart-btn {
            background: var(--error-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .clear-cart-btn:hover {
            background: #c82333;
            transform: translateY(-2px);
        }

        /* Product Line Headers */
        .product-line-header {
            background: linear-gradient(135deg, var(--primary-green), var(--secondary-green));
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            margin: 30px 0 20px 0;
            text-align: center;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .product-line-info {
            text-align: left;
        }

        .product-line-header h3 {
            margin: 0;
            font-size: 1.3em;
        }

        .product-line-header p {
            margin: 5px 0 0 0;
            opacity: 0.9;
            font-size: 0.9em;
        }

        .clear-line-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s ease;
        }

        .clear-line-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
        }

        .benefits-selection-info {
            background: #e7f3ff;
            color: #0066cc;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #b3d9ff;
            text-align: center;
            font-weight: 600;
        }

        .clear-order-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 15px;
        }

        .clear-order-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
        }

          /* Products Grid */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 25px;
            margin-top: 25px;
        }

        .product-card {
            background: var(--medium-bg);
            border-radius: 15px;
            padding: 25px;
            border: 2px solid var(--border-color);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            border-color: var(--primary-green);
        }

        .product-card::before {
            content: \'\';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-green), var(--secondary-green));
        }

        .product-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 10px;
            margin-bottom: 15px;
        }.product-header {
            margin-bottom: 15px;
        }

        .product-name {
            font-size: 1.2em;
            font-weight: bold;
            color: var(--text-primary);
            margin-bottom: 5px;
            line-height: 1.3;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .expand-icon {
            color: var(--primary-green);
            cursor: pointer;
            font-size: 0.9em;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.3s ease;
            padding: 2px 6px;
            border-radius: 4px;
            background: rgba(40, 167, 69, 0.1);
        }

        .expand-icon:hover {
            background: rgba(40, 167, 69, 0.2);
            transform: scale(1.05);
        }

        .product-sku {
            font-size: 0.8em;
            color: var(--text-secondary);
            font-family: 'Courier New', monospace;
            margin-bottom: 10px;
            opacity: 0.7;
        }

        .product-price {
            font-size: 1.4em;
            font-weight: bold;
            color: var(--primary-green);
            margin-bottom: 8px;
        }

        .product-margin {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            color: #333;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
            display: inline-block;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(255, 215, 0, 0.3);
        }

        .product-min {
            font-size: 0.9em;
            color: var(--text-secondary);
            margin-bottom: 15px;
        }

        .product-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
        }

        .quantity-controls {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .quantity-btn {
            background: var(--primary-green);
            color: white;
            border: none;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
            transition: all 0.3s ease;
        }

        .quantity-btn:hover {
            background: var(--secondary-green);
            transform: scale(1.1);
        }

        .quantity-btn:disabled {
            background: var(--border-color);
            cursor: not-allowed;
            transform: none;
        }

        .quantity-input {
            width: 60px;
            text-align: center;
            padding: 8px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            background: var(--light-bg);
            color: var(--text-primary);
        }

        /* Benefits Section */
        .benefits-section {
            background: var(--light-bg);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid var(--border-color);
            backdrop-filter: blur(10px);
        }

        .benefits-section h2 {
            color: var(--primary-green);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .benefits-info {
            background: #fff3cd;
            color: #856404;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #ffeaa7;
            text-align: center;
            font-weight: 600;
        }

        .benefits-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .benefit-card {
            background: var(--medium-bg);
            border-radius: 12px;
            padding: 20px;
            border: 2px solid var(--border-color);
            transition: all 0.3s ease;
            position: relative;
        }

        .benefit-card.available {
            border-color: var(--primary-green);
            background: rgba(40, 167, 69, 0.05);
        }

        .benefit-card.unavailable {
            opacity: 0.5;
            background: rgba(108, 117, 125, 0.1);
        }

        .benefit-header {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            margin-bottom: 15px;
        }

        .benefit-checkbox {
            width: 20px;
            height: 20px;
            margin-top: 2px;
        }

        .benefit-checkbox:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .benefit-info {
            flex: 1;
        }

        .benefit-name {
            font-weight: bold;
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .benefit-description {
            color: var(--text-secondary);
            font-size: 0.9em;
            line-height: 1.4;
        }

        .benefit-minimum {
            color: var(--warning-color);
            font-size: 0.8em;
            font-weight: 600;
            margin-top: 8px;
        }

        /* Order Summary */
        .order-summary {
            background: linear-gradient(135deg, var(--primary-green), var(--secondary-green));
            color: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(40, 167, 69, 0.3);
        }

        .order-summary h2 {
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .order-items {
            margin-bottom: 20px;
        }

        .order-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .order-item:last-child {
            border-bottom: none;
        }

        .order-total {
            font-size: 1.5em;
            font-weight: bold;
            text-align: center;
            padding: 20px 0;
            border-top: 2px solid rgba(255, 255, 255, 0.3);
            margin-top: 20px;
        }

        /* Comments Section */
        .comments-section {
            background: var(--light-bg);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid var(--border-color);
            backdrop-filter: blur(10px);
        }

        .comments-section h2 {
            color: var(--primary-green);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .comments-section textarea {
            min-height: 120px;
            resize: vertical;
        }

        /* Submit Button */
        .submit-section {
            text-align: center;
            margin-top: 40px;
        }

        .submit-btn {
            background: linear-gradient(135deg, var(--primary-green), var(--secondary-green));
            color: white;
            border: none;
            padding: 18px 40px;
            border-radius: 50px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 6px 20px rgba(40, 167, 69, 0.3);
            min-width: 250px;
        }

        .submit-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(40, 167, 69, 0.4);
        }

        .submit-btn:disabled {
            background: var(--border-color);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Success Message */
        .success-message {
            display: none;
            background: linear-gradient(135deg, var(--success-color), var(--secondary-green));
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            margin-top: 30px;
            box-shadow: 0 10px 30px rgba(40, 167, 69, 0.3);
        }

        .success-message h3 {
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .success-message p {
            line-height: 1.6;
            margin-bottom: 10px;
        }

        /* Image Modal */
        .image-modal {
            display: none;
            position: fixed;
            z-index: 10000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(5px);
        }

        .image-modal-content {
            position: relative;
            margin: auto;
            padding: 20px;
            width: 90%;
            max-width: 800px;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .image-modal img {
            max-width: 100%;
            max-height: 90vh;
            object-fit: contain;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .image-modal-close {
            position: absolute;
            top: 20px;
            right: 30px;
            color: white;
            font-size: 40px;
            font-weight: bold;
            cursor: pointer;
            z-index: 10001;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .image-modal-close:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
        }

        .product-image {
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .product-image:hover {
            transform: scale(1.05);
            filter: brightness(1.1);
        }

        /* Image Container */
        .image-container {
            position: relative;
            overflow: hidden;
            border-radius: 10px;
        }

        .image-overlay {
            display: none; /* Removido o overlay de hover */
        }

        .expand-text {
            display: none; /* Removido o texto de expandir */
        }

        /* Mobile touch support */
        @media (max-width: 768px) {
            .image-overlay {
                display: none;
            }
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 30px;
            background: var(--light-bg);
            border-radius: 15px;
            border: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .logo-image {
            height: 80px;
            width: auto;
            transition: all 0.3s ease;
        }

        .logo-text {
            text-align: left;
        }

        .whatsapp-text {
            max-width: 600px;
            text-align: center;
            line-height: 1.6;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
                padding-bottom: 100px;
            }

            .header {
                text-align: center;
                margin-bottom: 30px;
                padding: 20px;
                background: var(--light-bg);
                border-radius: 15px;
                border: 1px solid var(--border-color);
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 20px;
            }

            .logo-container {
                display: flex;
                align-items: center;
                gap: 15px;
            }

            .logo-image {
                height: 60px;
                width: auto;
                transition: all 0.3s ease;
            }

            .logo-text h1 {
                font-size: 2.5em !important;
                margin: 0;
            }

            .whatsapp-text {
                font-size: 0.9em;
            }
            }

            .cart-summary {
                position: fixed;
                bottom: 20px;
                right: 20px;
                min-width: 180px;
                padding: 12px 16px;
                font-size: 0.9em;
            }

            .theme-toggle {
                top: 10px;
                right: 10px;
                padding: 8px 12px;
            }

            .products-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .products-header {
                flex-direction: column;
                align-items: stretch;
            }

            .products-controls {
                justify-content: center;
            }

            .existing-customer-form {
                flex-direction: column;
            }

            .existing-customer-form .form-group {
                min-width: auto;
            }

            .benefits-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }
    </style>
</head>
<body>
    <div class="loading-spinner">
        <div class="spinner"></div>
    </div>

    <div class="theme-toggle" onclick="toggleTheme()">
        <i class="fas fa-sun"></i>
    </div>

    <div class="cart-summary" onclick="toggleCartModal()">
        <div class="cart-total">Total: R$ 0,00</div>
        <div class="cart-count">0 itens</div>
    </div>

    <div class="container">
        <div class="header">
            <div class="logo-container">
                <img src="images/Kilombo93_semcor.png" 
                     alt="Kilombo 93 Logo" 
                     class="logo-image logo-light" 
                     id="logo-light">
                <img src="images/Kilombo93_preto.png" 
                     alt="Kilombo 93 Logo" 
                     class="logo-image logo-dark" 
                     id="logo-dark" 
                     style="display: none;">
            </div>
            <div class="whatsapp-text">
                Boas vindas ao ambiente de compras em atacado do Kilombo 93. Estamos prontos e empolgados para receber o seu pedido.
            </div>
            <a href="https://wa.me/5511961054515?text=Ol%C3%A1%2C%0APreciso%20de%20ajuda%20para%20efetuar%20uma%20compra%20de%20atacado%20com%20o%20Kilombo%2093.%0AFico%20no%20aguardo!" target="_blank" class="whatsapp-link">
                <i class="fab fa-whatsapp"></i> clique aqui e fale conosco no WhatsApp
            </a>
        </div>

        <!-- Existing Customer Section -->
        <div class="existing-customer">
            <h2><i class="fas fa-user-check"></i> Já sou cliente</h2>
            <p>Se você já fez pedidos conosco anteriormente, digite seu CNPJ abaixo para carregar automaticamente suas informações e agilizar seu novo pedido.</p>
            <div class="existing-customer-form">
                <div class="form-group">
                    <label for="existing-cnpj">CNPJ da sua empresa</label>
                    <input type="text" id="existing-cnpj" placeholder="00.000.000/0000-00" maxlength="18">
                </div>
                <button type="button" onclick="searchExistingCustomer()">
                    <i class="fas fa-search"></i> Buscar
                </button>
            </div>
        </div>

        <form id="orderForm">
            <div class="form-section">
                <h2><i class="fas fa-building"></i> Informações da Empresa</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="company-name">Nome da Loja/Empresa *</label>
                        <input type="text" id="company-name" required>
                    </div>
                    <div class="form-group">
                        <label for="cnpj">CNPJ *</label>
                        <input type="text" id="cnpj" placeholder="00.000.000/0000-00" maxlength="18" required>
                    </div>
                    <div class="form-group">
                        <label for="responsible-name">Nome do Responsável *</label>
                        <input type="text" id="responsible-name" required>
                    </div>
                    <div class="form-group">
                        <label for="email">E-mail *</label>
                        <input type="email" id="email" required>
                    </div>
                    <div class="form-group">
                        <label for="phone">Telefone *</label>
                        <input type="text" id="phone" placeholder="(11) 99999-9999" maxlength="15" required>
                    </div>
                    <div class="form-group">
                        <label for="state">Estado *</label>
                        <select id="state" required onchange="updateCities()">
                            <option value="">Selecione o estado</option>
                            <option value="AC">Acre</option>
                            <option value="AL">Alagoas</option>
                            <option value="AP">Amapá</option>
                            <option value="AM">Amazonas</option>
                            <option value="BA">Bahia</option>
                            <option value="CE">Ceará</option>
                            <option value="DF">Distrito Federal</option>
                            <option value="ES">Espírito Santo</option>
                            <option value="GO">Goiás</option>
                            <option value="MA">Maranhão</option>
                            <option value="MT">Mato Grosso</option>
                            <option value="MS">Mato Grosso do Sul</option>
                            <option value="MG">Minas Gerais</option>
                            <option value="PA">Pará</option>
                            <option value="PB">Paraíba</option>
                            <option value="PR">Paraná</option>
                            <option value="PE">Pernambuco</option>
                            <option value="PI">Piauí</option>
                            <option value="RJ">Rio de Janeiro</option>
                            <option value="RN">Rio Grande do Norte</option>
                            <option value="RS">Rio Grande do Sul</option>
                            <option value="RO">Rondônia</option>
                            <option value="RR">Roraima</option>
                            <option value="SC">Santa Catarina</option>
                            <option value="SP">São Paulo</option>
                            <option value="SE">Sergipe</option>
                            <option value="TO">Tocantins</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="city">Cidade *</label>
                        <select id="city" required disabled>
                            <option value="">Primeiro selecione o estado</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="store-count">Quantidade de Lojas *</label>
                        <input type="number" id="store-count" min="1" required>
                    </div>
                    <div class="form-group">
                        <label for="sellers-per-store">Quantidade Média de Vendedores por Loja *</label>
                        <input type="number" id="sellers-per-store" min="1" required>
                    </div>
                    <div class="form-group">
                        <label for="website">Site da Loja</label>
                        <input type="url" id="website" placeholder="https://www.exemplo.com">
                    </div>
                    <div class="form-group">
                        <label for="instagram">Instagram da Loja</label>
                        <input type="text" id="instagram" placeholder="@nomeloja">
                    </div>
                    <div class="form-group">
                        <label for="tiktok">TikTok da Loja</label>
                        <input type="text" id="tiktok" placeholder="@nomeloja">
                    </div>
                    <div class="form-group">
                        <label for="payment-preference">Forma de Pagamento Preferida *</label>
                        <select id="payment-preference" required>
                            <option value="">Selecione uma opção</option>
                            <option value="50-30-days">50% à vista e 50% até 30 dias subsequentes à entrega</option>
                            <option value="pix-transfer">Pix ou transferência à vista</option>
                            <option value="credit-card">Cartões de crédito com parcelamento até 12x com juros</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="products-section">
                <div class="products-header">
                    <h2><i class="fas fa-tshirt"></i> Produtos Disponíveis</h2>
                    <div class="products-controls">
                        <input type="text" class="search-input" placeholder="Buscar produtos..." onkeyup="filterProducts()">
                        <select class="filter-select" onchange="filterByLine(this.value)">
                            <option value="">Todas as linhas</option>
                            <option value="baoba">Linha Baobá</option>
                            <option value="wakanda">Linha Wakanda</option>
                            <option value="kilombo">Linha Kilombo</option>
                        </select>
                    </div>
                </div>

                <!-- Linha Baobá -->
                <div class="product-line-header">
                    <div class="product-line-info">
                        <h3>Linha Baobá</h3>
                        <p>Produtos de entrada e experimentação</p>
                    </div>
                    <button type="button" class="clear-line-btn" onclick="clearLine('baoba')">
                        <i class="fas fa-trash"></i> Limpar Linha
                    </button>
                </div>
                <div class="products-grid" id="baoba-products">
                    <!-- Produtos da Linha Baobá serão inseridos aqui via JavaScript -->
                </div>

                <!-- Linha Wakanda -->
                <div class="product-line-header">
                    <div class="product-line-info">
                        <h3>Linha Wakanda</h3>
                        <p>Produtos intermediários</p>
                    </div>
                    <button type="button" class="clear-line-btn" onclick="clearLine('wakanda')">
                        <i class="fas fa-trash"></i> Limpar Linha
                    </button>
                </div>
                <div class="products-grid" id="wakanda-products">
                    <!-- Produtos da Linha Wakanda serão inseridos aqui via JavaScript -->
                </div>

                <!-- Linha Kilombo -->
                <div class="product-line-header">
                    <div class="product-line-info">
                        <h3>Linha Kilombo</h3>
                        <p>Produtos premium e de luxo</p>
                    </div>
                    <button type="button" class="clear-line-btn" onclick="clearLine('kilombo')">
                        <i class="fas fa-trash"></i> Limpar Linha
                    </button>
                </div>
                <div class="products-grid" id="kilombo-products">
                    <!-- Produtos da Linha Kilombo serão inseridos aqui via JavaScript -->
                </div>
            </div>

            <!-- Benefits Section -->
            <div class="benefits-section">
                <h2><i class="fas fa-gift"></i> Benefícios Exclusivos</h2>
                <p>Selecione os benefícios que deseja receber com seu pedido. A disponibilidade dos benefícios depende do valor total do seu pedido.</p>
                
                <div class="benefits-info" id="benefits-info">
                    Adicione mais R$ 7.500,00 para ter acesso aos benefícios.
                </div>

                <div class="benefits-selection-info" id="benefits-selection-info" style="display: none;">
                    Você tem direito a selecionar benefícios. Marque quais você quer receber (opcional).
                </div>

                <div class="benefits-grid" id="benefits-grid">
                    <!-- Benefícios serão inseridos aqui via JavaScript -->
                </div>
            </div>

            <!-- Order Summary -->
            <div class="order-summary">
                <h2><i class="fas fa-receipt"></i> Resumo do Pedido</h2>
                <div class="order-items" id="order-items">
                    <p>Nenhum produto adicionado ainda.</p>
                </div>
                <div class="order-total" id="order-total">Total: R$ 0,00</div>
            </div>

            <!-- Comments Section -->
            <div class="comments-section">
                <h2><i class="fas fa-comment"></i> Observações Adicionais</h2>
                <div class="form-group">
                    <label for="comments">Observações sobre o pedido</label>
                    <textarea id="comments" placeholder="Descreva qualquer observação especial sobre o pedido, preferências de entrega, etc."></textarea>
                </div>
            </div>

            <div class="submit-section">
                <button type="submit" class="submit-btn" id="submit-btn" disabled>
                    <i class="fas fa-exclamation-triangle"></i> Mínimo: R$ 7.500,00
                </button>
            </div>
        </form>

        <div class="success-message" id="success-message">
            <h3>Pedido Enviado com Sucesso!</h3>
            <p id="success-text"></p>
        </div>

        <!-- Image Modal -->
        <div id="imageModal" class="image-modal" onclick="closeImageModal()">
            <div class="image-modal-content">
                <span class="image-modal-close" onclick="closeImageModal()">&times;</span>
                <img id="modalImage" src="" alt="Produto">
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let cart = [];
        let cartTotal = 0;
        let isExistingCustomer = false;
        let selectedBenefits = [];
        let sizeSelections = {}; // Armazena seleções de tamanho por produto

        // Products data with images
        const products = [
            // Linha Baobá
            { 
                id: 'K93BONEESSENTIAL2025', 
                name: 'Boné K93 Essential', 
                price: 78.40, 
                profit: 60.60,
                minQuantity: 12, 
                line: 'baoba', 
                margin: 'Margem: 43.60%',
                image: 'images/bone-k93-essential.jpg'
            },
            { 
                id: 'K93CAMISETAESSENTIAL2025', 
                name: 'Camiseta K93 Essential', 
                price: 104.88, 
                profit: 54.13,
                minQuantity: 12, 
                line: 'baoba', 
                margin: 'Margem: 34.04%',
                image: 'images/camiseta-k93-essential.png'
            },
            { 
                id: 'K93CONJUNTOCINZAS2025', 
                name: 'Conjunto Cinzas', 
                price: 174.20, 
                profit: 74.80,
                minQuantity: 6, 
                line: 'baoba', 
                margin: 'Margem: 30.04%',
                image: 'images/conjunto-cinzas.png'
            },
            { 
                id: 'K93CONJUNTOCARBONO2025', 
                name: 'Conjunto Carbono', 
                price: 174.20, 
                profit: 74.80,
                minQuantity: 6, 
                line: 'baoba', 
                margin: 'Margem: 30.04%',
                image: 'images/conjunto-carbono.png'
            },

            // Linha Wakanda
            { 
                id: 'K93CAMISETAACUCAR2025', 
                name: 'Camiseta Açucar', 
                price: 139.84, 
                profit: 67.65,
                minQuantity: 12, 
                line: 'wakanda', 
                margin: 'Margem: 35.79%',
                image: 'images/camiseta-acucar.png'
            },
            { 
                id: 'K93CAMISETAAFRIKAOURO2025', 
                name: 'Camiseta Afrika de Ouro', 
                price: 139.84, 
                profit: 68.00,
                minQuantity: 12, 
                line: 'wakanda', 
                margin: 'Margem: 31.05%',
                image: 'images/camiseta-afrika-de-ouro.png'
            },
            { 
                id: 'K93CAMISETACAFE2025', 
                name: 'Camiseta Café', 
                price: 139.84, 
                profit: 67.65,
                minQuantity: 12, 
                line: 'wakanda', 
                margin: 'Margem: 35.79%',
                image: 'images/camiseta-cafe.png'
            },
            { 
                id: 'K93CAMISETAKENDRICK2025', 
                name: 'Camiseta Kendrick Lamar - They Not Like Us', 
                price: 139.84, 
                profit: 63.43,
                minQuantity: 12, 
                line: 'wakanda', 
                margin: 'Margem: 35.44%',
                image: 'images/camiseta-kendrick-lamar.png'
            },
            { 
                id: 'K93CAMISETAPADRONAGEM2025', 
                name: 'Camiseta PadronagemMonograma Realeza', 
                price: 139.84, 
                profit: 63.43,
                minQuantity: 12, 
                line: 'wakanda', 
                margin: 'Margem: 35.44%',
                image: 'images/camiseta-padronagem-monograma-realeza.png'
            },
            { 
                id: 'K93CAMISETABOXYMINHAFE2025', 
                name: 'Camiseta Boxy Minha Fé É Forte - 5 Cores', 
                price: 139.84, 
                profit: 95.65,
                minQuantity: 12, 
                line: 'wakanda', 
                margin: 'Margem: 41.77%',
                image: 'images/camiseta-boxy-minha-fe-forte.png'
            },
            { 
                id: 'K93CAMISETABOXYMAIS2025', 
                name: 'Camiseta Boxy Minha Mais Forte', 
                price: 139.84, 
                profit: 91.40,
                minQuantity: 12, 
                line: 'wakanda', 
                margin: 'Margem: 38.24%',
                image: 'images/camiseta-boxy-minha-mais-forte.png'
            },
            { 
                id: 'K93CASACOAMOR2025', 
                name: 'Casaco de Moletom Canguru Kilombo 93 - Amor Verdadeiro', 
                price: 244.76, 
                profit: 129.12,
                minQuantity: 6, 
                line: 'wakanda', 
                margin: 'Margem: 30.10%',
                image: 'images/casaco-moletom-amor-verdadeiro.png'
            },
            { 
                id: 'K93CASACOCORACAO2025', 
                name: 'Casaco de Moletom Canguru Kilombo 93 - Meu Coração', 
                price: 244.76, 
                profit: 153.12,
                minQuantity: 6, 
                line: 'wakanda', 
                margin: 'Margem: 35.69%',
                image: 'images/casaco-moletom-meu-coracao.png'
            },
            { 
                id: 'K93CORTAVENTO2025', 
                name: 'Corta-vento Padronagem', 
                price: 244.76, 
                profit: 117.92,
                minQuantity: 6, 
                line: 'wakanda', 
                margin: 'Margem: 30.31%',
                image: 'images/corta-vento-padronagem.png'
            },
            { 
                id: 'K93CROPPEDRAIZ2025', 
                name: 'Cropped Raiz Profunda', 
                price: 141.90, 
                profit: 77.10,
                minQuantity: 12, 
                line: 'wakanda', 
                margin: 'Margem: 35.21%',
                image: 'images/cropped-raiz-profunda.png'
            },
            { 
                id: 'K93VESTIDOCHAMAS2025', 
                name: 'Vestido Chamas', 
                price: 127.20, 
                profit: 91.80,
                minQuantity: 6, 
                line: 'wakanda', 
                margin: 'Margem: 41.92%',
                image: 'images/vestido-chamas.png'
            },
            { 
                id: 'K93VESTIDOREGATAMARE2025', 
                name: 'Vestido Regata Esportiva Maré De Paz', 
                price: 108.00, 
                profit: 91.00,
                minQuantity: 6, 
                line: 'wakanda', 
                margin: 'Margem: 45.73%',
                image: 'images/vestido-regata-mare-de-paz.png'
            },
            { 
                id: 'K93VESTIDOREGATAOURO2025', 
                name: 'Vestido Regata Esportiva Ouro Líquido', 
                price: 108.00, 
                profit: 91.00,
                minQuantity: 6, 
                line: 'wakanda', 
                margin: 'Margem: 45.73%',
                image: 'images/vestido-regata-ouro-liquido.png'
            },

            // Linha Kilombo
            { 
                id: 'K93CAMISETABOXYEXPLOSAO2025', 
                name: 'Camiseta Boxy Explosão', 
                price: 179.42, 
                profit: 89.59,
                minQuantity: 12, 
                line: 'kilombo', 
                margin: 'Margem: 33.30%',
                image: 'images/camiseta-boxy-explosao.png'
            },
            { 
                id: 'K93CAMISETABOXYKURA2025', 
                name: 'Camiseta Boxy Kura', 
                price: 179.42, 
                profit: 89.59,
                minQuantity: 12, 
                line: 'kilombo', 
                margin: 'Margem: 33.30%',
                image: 'images/camiseta-boxy-kura.png'
            },
            { 
                id: 'K93CAMISETASEGUNDA2025', 
                name: 'Camiseta de Segunda-Feira', 
                price: 224.94, 
                profit: 154.06,
                minQuantity: 12, 
                line: 'kilombo', 
                margin: 'Margem: 40.65%',
                image: 'images/camiseta-segunda-feira.png'
            },
            { 
                id: 'K93CAMISETASEXTA2025', 
                name: 'Camiseta de Sexta-Feira', 
                price: 224.94, 
                profit: 154.06,
                minQuantity: 12, 
                line: 'kilombo', 
                margin: 'Margem: 40.65%',
                image: 'images/camiseta-sexta-feira.png'
            },
            { 
                id: 'K93CAMISETAMOVIMENTOSOFF2025', 
                name: 'Camiseta MOVIMENTOS & ESTRUTURA off white', 
                price: 173.63, 
                profit: 75.38,
                minQuantity: 12, 
                line: 'kilombo', 
                margin: 'Margem: 30.27%',
                image: 'images/camiseta-movimentos-estrutura-off-white.png'
            },
            { 
                id: 'K93CAMISETAMOVIMENTOSPRETA2025', 
                name: 'Camiseta MOVIMENTOS & ESTRUTURA Preta', 
                price: 173.63, 
                profit: 75.38,
                minQuantity: 12, 
                line: 'kilombo', 
                margin: 'Margem: 30.27%',
                image: 'images/camiseta-movimentos-estrutura-preta.png'
            },
            { 
                id: 'K93JAQUETAPUFFER2025', 
                name: 'Jaqueta Puffer Lava', 
                price: 536.30, 
                profit: 362.70,
                minQuantity: 6, 
                line: 'kilombo', 
                margin: 'Margem: 40.34%',
                image: 'images/jaqueta-puffer-lava.png'
            },
            { 
                id: 'K93VESTIDONOITE2025', 
                name: 'Vestido Noite Ardente', 
                price: 328.00, 
                profit: 171.00,
                minQuantity: 6, 
                line: 'kilombo', 
                margin: 'Margem: 34.27%',
                image: 'images/vestido-noite-ardente.png'
            }
        ];

        // Benefits data based on BENEFICIOSV0.txt
        const benefits = [
            {
                id: 'ecobag',
                name: 'Ecobag ou Dust bag',
                description: 'Embalagens ecológicas personalizadas para cada unidade solicitada',
                minimum: 7500,
                level: 1,
                type: 'always'
            },
            {
                id: 'adesivo',
                name: 'Adesivo de vitrine personalizado',
                description: 'Adesivo personalizado para vitrine da sua loja',
                minimum: 15000,
                level: 1,
                type: 'selectable'
            },
            {
                id: 'trafego3',
                name: '3% em Tráfego Pago',
                description: '3% do total dessa compra bonificado em tráfego pago para sua loja física ou online, gerido pelo Kilombo 93',
                minimum: 25000,
                level: 1,
                type: 'selectable'
            },
            {
                id: 'influencers',
                name: 'Influencers in loco',
                description: 'Ativação com influencers locais da sua região',
                minimum: 35000,
                level: 1,
                type: 'selectable'
            },
            {
                id: 'trafego5',
                name: '5% em Tráfego Pago',
                description: '5% do total dessa compra bonificado em tráfego pago para sua loja física ou online, gerido pelo Kilombo 93',
                minimum: 50000,
                level: 2,
                type: 'selectable'
            },
            {
                id: 'evento',
                name: 'Evento in loco',
                description: 'Organização de evento na sua loja',
                minimum: 50000,
                level: 2,
                type: 'selectable'
            },
            {
                id: 'colaboracao',
                name: 'Colaboração',
                description: 'Desenvolvimento de produtos exclusivos com a marca e qualidade Kilombo 93 e a marca da sua loja',
                minimum: 75000,
                level: 2,
                type: 'selectable'
            }
        ];

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            renderProducts();
            renderBenefits();
            
            // CNPJ formatting
            document.getElementById('cnpj').addEventListener('input', formatCNPJ);
            document.getElementById('existing-cnpj').addEventListener('input', formatCNPJ);
            
            // Phone formatting
            document.getElementById('phone').addEventListener('input', formatPhone);
            
            // Mobile touch support for image overlay
        });


        // Render products
        function renderProducts() {
            const baobaContainer = document.getElementById('baoba-products');
            const wakandaContainer = document.getElementById('wakanda-products');
            const kilomboContainer = document.getElementById('kilombo-products');

            products.forEach(product => {
                const productCard = createProductCard(product);
                
                if (product.line === 'baoba') {
                    baobaContainer.appendChild(productCard);
                } else if (product.line === 'wakanda') {
                    wakandaContainer.appendChild(productCard);
                } else if (product.line === 'kilombo') {
                    kilomboContainer.appendChild(productCard);
                }
            });
        }

        // Create product card
        function createProductCard(product) {
            const card = document.createElement('div');
            card.className = 'product-card';
            card.setAttribute('data-line', product.line);
            card.setAttribute('data-name', product.name.toLowerCase());

            // Verificar se o produto tem tamanhos definidos no productSizes
            let controlsHTML = '';
            
            if (productSizes[product.id] && productSizes[product.id].sizes && productSizes[product.id].sizes.length > 0) {
                // Modal de tamanhos para produtos com tamanhos definidos
                controlsHTML = `
                    <div class="product-controls">
                        <button type="button" class="choose-sizes-btn" onclick="openSizeModal('${product.id}')" 
                                style="width: 100%; padding: 12px; background: linear-gradient(135deg, #4CAF50, #45a049); color: white; border: none; border-radius: 8px; cursor: pointer; margin-bottom: 10px; transition: all 0.3s ease;">
                            🎽 Escolher Tamanhos
                        </button>
                        <div class="selected-sizes-summary" id="sizes-summary-${product.id}" style="font-size: 0.9em; color: #ccc; text-align: center;">
                            Nenhum tamanho selecionado
                        </div>
                    </div>
                `;
            } else {
                // Controles padrão para produtos sem tamanhos (tamanho único)
                controlsHTML = `
                    <div class="product-controls">
                        <div class="quantity-controls">
                            <button type="button" class="quantity-btn" onclick="decreaseQuantity('${product.id}')">-</button>
                            <input type="number" class="quantity-input" id="qty-${product.id}" value="0" min="0" onchange="updateQuantity('${product.id}', this.value)">
                            <button type="button" class="quantity-btn" onclick="increaseQuantity('${product.id}')">+</button>
                        </div>
                    </div>
                `;
            }

            card.innerHTML = `
                <div class="image-container">
                    <img src="${product.image}" alt="${product.name}" class="product-image" onclick="openImageModal('${product.image}', '${product.name}')" onerror="this.style.display='none'">
                </div>
                <div class="product-header">
                    <div class="product-name">
                        ${product.name}
                        <span class="expand-icon" onclick="openImageModal('${product.image}', '${product.name}')">
                            <i class="fas fa-search-plus"></i>
                            <span>expandir foto</span>
                        </span>
                    </div>
                    <div class="product-sku">SKU: ${product.id}</div>
                    <div class="product-price">R$ ${formatCurrency(product.price)}</div>
                    <div class="product-margin">${product.margin}</div>
                    <div class="product-min">Mínimo: ${product.minQuantity} unidades</div>
                </div>
                ${controlsHTML}
            `;

            return card;
        }

        // Render benefits
        function renderBenefits() {
            const benefitsContainer = document.getElementById('benefits-grid');
            
            benefits.forEach(benefit => {
                const benefitCard = createBenefitCard(benefit);
                benefitsContainer.appendChild(benefitCard);
            });
            
            updateBenefitsAvailability();
        }

        // Create benefit card
        function createBenefitCard(benefit) {
            const card = document.createElement('div');
            card.className = 'benefit-card';
            card.id = `benefit-${benefit.id}`;

            const isCheckbox = benefit.type === 'selectable';
            const inputType = isCheckbox ? 'checkbox' : 'hidden';
            const inputElement = isCheckbox ? 
                `<input type="checkbox" class="benefit-checkbox" id="check-${benefit.id}" onchange="toggleBenefit('${benefit.id}')" disabled>` : 
                '';

            card.innerHTML = `
                <div class="benefit-header">
                    ${inputElement}
                    <div class="benefit-info">
                        <div class="benefit-name">${benefit.name}</div>
                        <div class="benefit-description">${benefit.description}</div>
                        <div class="benefit-minimum">Mínimo: R$ ${formatCurrency(benefit.minimum)}</div>
                    </div>
                </div>
            `;

            return card;
        }

        // Product quantity functions
        function increaseQuantity(productId) {
            const input = document.getElementById(`qty-${productId}`);
            const product = products.find(p => p.id === productId);
            let currentValue = parseInt(input.value) || 0;
            
            if (currentValue === 0) {
                currentValue = product.minQuantity;
            } else {
                currentValue += product.minQuantity;
            }
            
            input.value = currentValue;
            updateQuantity(productId, currentValue);
        }

        function decreaseQuantity(productId) {
            const input = document.getElementById(`qty-${productId}`);
            const product = products.find(p => p.id === productId);
            let currentValue = parseInt(input.value) || 0;
            
            if (currentValue >= product.minQuantity) {
                currentValue -= product.minQuantity;
                if (currentValue < product.minQuantity && currentValue > 0) {
                    currentValue = 0;
                }
            }
            
            input.value = currentValue;
            updateQuantity(productId, currentValue);
        }

        function updateQuantity(productId, quantity) {
            const product = products.find(p => p.id === productId);
            const qty = parseInt(quantity) || 0;
            
            // Validate minimum quantity
            if (qty > 0 && qty < product.minQuantity) {
                document.getElementById(`qty-${productId}`).value = product.minQuantity;
                return;
            }
            
            // Update cart
            const existingItem = cart.find(item => item.id === productId);
            
            if (qty === 0) {
                cart = cart.filter(item => item.id !== productId);
            } else if (existingItem) {
                existingItem.quantity = qty;
                existingItem.total = qty * product.price;
            } else {
                cart.push({
                    id: productId,
                    name: product.name,
                    price: product.price,
                    quantity: qty,
                    total: qty * product.price
                });
            }
            
            updateCartDisplay();
            updateOrderSummary();
            updateBenefitsAvailability();
            updateSubmitButton();
        }

        // Update cart display
        function updateCartDisplay() {
            cartTotal = cart.reduce((sum, item) => sum + item.total, 0);
            const cartCount = cart.reduce((sum, item) => sum + item.quantity, 0);
            
            document.querySelector('.cart-total').textContent = `Total: R$ ${formatCurrency(cartTotal)}`;
            document.querySelector('.cart-count').textContent = `${cartCount} itens`;
        }

        // Update order summary
        function updateOrderSummary() {
            const orderItems = document.getElementById('order-items');
            const orderTotal = document.getElementById('order-total');
            
            if (cart.length === 0) {
                orderItems.innerHTML = '<p>Nenhum produto adicionado ainda.</p>';
            } else {
                orderItems.innerHTML = cart.map(item => `
                    <div class="order-item">
                        <span>${item.name} (${item.quantity}x)</span>
                        <span>R$ ${formatCurrency(item.total)}</span>
                    </div>
                `).join('');
            }
            
            // CORREÇÃO: Calcular lucro considerando produtos com e sem modal
            const totalProfit = cart.reduce((sum, item) => {
                // Buscar produto original (pode ter sufixo de tamanho para produtos com modal)
                const baseId = item.id.split('-')[0];
                const product = products.find(p => p.id === baseId || p.id === item.id);
                return sum + (product ? product.profit * item.quantity : 0);
            }, 0);
            
            orderTotal.innerHTML = `
                <div>Total do Pedido: R$ ${formatCurrency(cartTotal)}</div>
                <div style="font-size: 0.85em; color: var(--text-secondary); margin-top: 5px;">
                    Estimativa de lucro bruto da sua loja: R$ ${formatCurrency(totalProfit)}
                </div>
            `;
        }

        // Update benefits availability
        function updateBenefitsAvailability() {
            const benefitsInfo = document.getElementById('benefits-info');
            const benefitsSelectionInfo = document.getElementById('benefits-selection-info');
            
            if (cartTotal < 7500) {
                const needed = 7500 - cartTotal;
                benefitsInfo.textContent = `Adicione mais R$ ${formatCurrency(needed)} para ter acesso aos benefícios.`;
                benefitsInfo.style.background = '#fff3cd';
                benefitsInfo.style.color = '#856404';
                benefitsInfo.style.display = 'block';
                benefitsSelectionInfo.style.display = 'none';
            } else {
                benefitsInfo.style.display = 'none';
                benefitsSelectionInfo.style.display = 'block';
                
                // Calculate available benefits
                let availableBenefitsCount = 0;
                let benefitText = '';
                
                if (cartTotal >= 75000) {
                    availableBenefitsCount = 2; // 2 nível 1 OU 1 nível 2
                    benefitText = 'Você tem direito a 2 benefícios nível 1 OU 1 benefício nível 2. Marque quais você quer receber (opcional).';
                } else if (cartTotal >= 50000) {
                    availableBenefitsCount = 2; // 2 nível 1 OU 1 nível 2
                    benefitText = 'Você tem direito a 2 benefícios nível 1 OU 1 benefício nível 2. Marque quais você quer receber (opcional).';
                } else if (cartTotal >= 35000) {
                    availableBenefitsCount = 1;
                    benefitText = 'Você tem direito a 1 benefício. Marque qual você quer receber (opcional).';
                } else if (cartTotal >= 25000) {
                    availableBenefitsCount = 1;
                    benefitText = 'Você tem direito a 1 benefício. Marque qual você quer receber (opcional).';
                } else if (cartTotal >= 15000) {
                    availableBenefitsCount = 1;
                    benefitText = 'Você tem direito a 1 benefício. Marque qual você quer receber (opcional).';
                } else {
                    availableBenefitsCount = 0;
                    benefitText = 'Benefícios automáticos incluídos no seu pedido!';
                }
                
                benefitsSelectionInfo.textContent = benefitText;
            }
            
            benefits.forEach(benefit => {
                const card = document.getElementById(`benefit-${benefit.id}`);
                const checkbox = document.getElementById(`check-${benefit.id}`);
                
                if (cartTotal >= benefit.minimum) {
                    card.classList.add('available');
                    card.classList.remove('unavailable');
                    if (checkbox) checkbox.disabled = false;
                } else {
                    card.classList.remove('available');
                    card.classList.add('unavailable');
                    if (checkbox) {
                        checkbox.disabled = true;
                        checkbox.checked = false;
                        // Remove from selected benefits if disabled
                        selectedBenefits = selectedBenefits.filter(id => id !== benefit.id);
                    }
                }
            });
            
            // Update benefit selection limits
            updateBenefitSelectionLimits();
        }

        // Update benefit selection limits
        function updateBenefitSelectionLimits() {
            if (cartTotal < 7500) return;
            
            const selectedLevel1 = selectedBenefits.filter(b => benefits.find(ben => ben.id === b)?.level === 1).length;
            const selectedLevel2 = selectedBenefits.filter(b => benefits.find(ben => ben.id === b)?.level === 2).length;
            
            benefits.forEach(benefit => {
                const checkbox = document.getElementById(`check-${benefit.id}`);
                const card = document.getElementById(`benefit-${benefit.id}`);
                
                // Skip if checkbox doesn't exist or benefit is not available due to minimum value
                if (!checkbox || cartTotal < benefit.minimum) return;
                
                let shouldDisable = false;
                
                if (cartTotal >= 50000) {
                    // Can select 2 level 1 OR 1 level 2
                    if (benefit.level === 1 && selectedLevel1 >= 2 && selectedLevel2 === 0 && !checkbox.checked) {
                        shouldDisable = true;
                    }
                    if (benefit.level === 2 && (selectedLevel1 > 0 || selectedLevel2 >= 1) && !checkbox.checked) {
                        shouldDisable = true;
                    }
                    if (benefit.level === 1 && selectedLevel2 > 0 && !checkbox.checked) {
                        shouldDisable = true;
                    }
                } else {
                    // Can select only 1 benefit
                    if (selectedLevel1 + selectedLevel2 >= 1 && !checkbox.checked) {
                        shouldDisable = true;
                    }
                }
                
                // Apply or remove disabled state
                if (shouldDisable) {
                    checkbox.disabled = true;
                    if (card) card.style.opacity = '0.5';
                } else {
                    checkbox.disabled = false;
                    if (card) card.style.opacity = '1';
                }
            });
        }

        // Toggle benefit selection
        function toggleBenefit(benefitId) {
            const checkbox = document.getElementById(`check-${benefitId}`);
            const benefit = benefits.find(b => b.id === benefitId);
            
            if (checkbox.checked) {
                selectedBenefits.push(benefitId);
            } else {
                selectedBenefits = selectedBenefits.filter(id => id !== benefitId);
            }
            
            updateBenefitSelectionLimits();
        }

        // Clear line function
        function clearLine(line) {
            const productsInLine = products.filter(p => p.line === line);
            
            productsInLine.forEach(product => {
                const input = document.getElementById(`qty-${product.id}`);
                if (input) {
                    input.value = 0;
                    updateQuantity(product.id, 0);
                }
            });
        }

        // Clear all order function
        function clearAllOrder() {
            if (confirm('Tem certeza que deseja limpar todo o seu pedido? Esta ação irá apagar tudo e não pode ser desfeita.')) {
                cart = [];
                selectedBenefits = [];
                
                // Reset all quantity inputs
                document.querySelectorAll('.quantity-input').forEach(input => {
                    input.value = 0;
                });
                
                // Reset all benefit checkboxes
                document.querySelectorAll('.benefit-checkbox').forEach(checkbox => {
                    checkbox.checked = false;
                });
                
                updateCartDisplay();
                updateOrderSummary();
                updateBenefitsAvailability();
                updateSubmitButton();
            }
        }

        // Update submit button
        function updateSubmitButton() {
            const submitBtn = document.getElementById('submit-btn');
            
            if (cartTotal >= 7500) {
                submitBtn.disabled = false;
                submitBtn.innerHTML = '<i class="fas fa-paper-plane"></i> Enviar Pedido';
                submitBtn.style.background = 'linear-gradient(135deg, var(--primary-green), var(--secondary-green))';
            } else {
                submitBtn.disabled = true;
                const needed = 7500 - cartTotal;
                submitBtn.innerHTML = `<i class="fas fa-exclamation-triangle"></i> Mínimo: R$ 7.500,00 (faltam R$ ${formatCurrency(needed)})`;
                submitBtn.style.background = 'var(--border-color)';
            }
        }

        // Format CNPJ
        function formatCNPJ(event) {
            let value = event.target.value.replace(/\D/g, '');
            value = value.replace(/^(\d{2})(\d)/, '$1.$2');
            value = value.replace(/^(\d{2})\.(\d{3})(\d)/, '$1.$2.$3');
            value = value.replace(/\.(\d{3})(\d)/, '.$1/$2');
            value = value.replace(/(\d{4})(\d)/, '$1-$2');
            event.target.value = value;
        }

        // Format currency to Brazilian format
        function formatCurrency(value) {
            return value.toLocaleString('pt-BR', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            });
        }

        // Format phone
        function formatPhone(event) {
            let value = event.target.value.replace(/\D/g, '');
            value = value.replace(/^(\d{2})(\d)/, '($1) $2');
            value = value.replace(/(\d{5})(\d)/, '$1-$2');
            event.target.value = value;
        }

        // Search existing customer
        function searchExistingCustomer() {
            const cnpj = document.getElementById('existing-cnpj').value;
            if (!cnpj) {
                alert('Por favor, digite um CNPJ válido.');
                return;
            }
            
            // Simulate customer search
            alert('Funcionalidade de busca de cliente será implementada em breve.');
        }

        // Filter products
        function filterProducts() {
            const searchTerm = document.querySelector('.search-input').value.toLowerCase();
            const productCards = document.querySelectorAll('.product-card');
            
            productCards.forEach(card => {
                const productName = card.getAttribute('data-name');
                if (productName.includes(searchTerm)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        // Filter by line
        function filterByLine(line) {
            const productCards = document.querySelectorAll('.product-card');
            
            productCards.forEach(card => {
                const productLine = card.getAttribute('data-line');
                if (!line || productLine === line) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        // Clear cart
        function clearCart() {
            if (confirm('Tem certeza que deseja limpar todo o carrinho?')) {
                cart = [];
                selectedBenefits = [];
                
                // Reset all quantity inputs
                document.querySelectorAll('.quantity-input').forEach(input => {
                    input.value = 0;
                });
                
                // Reset all benefit checkboxes
                document.querySelectorAll('.benefit-checkbox').forEach(checkbox => {
                    checkbox.checked = false;
                });
                
                updateCartDisplay();
                updateOrderSummary();
                updateBenefitsAvailability();
                updateSubmitButton();
            }
        }

        // Image Modal Functions
        function openImageModal(imageSrc, productName) {
            const modal = document.getElementById('imageModal');
            const modalImg = document.getElementById('modalImage');
            
            modal.style.display = 'block';
            modalImg.src = imageSrc;
            modalImg.alt = productName;
            
            // Prevent body scroll when modal is open
            document.body.style.overflow = 'hidden';
        }

        function closeImageModal() {
            const modal = document.getElementById('imageModal');
            modal.style.display = 'none';
            
            // Restore body scroll
            document.body.style.overflow = 'auto';
        }

        // Close modal when clicking outside the image
        document.getElementById('imageModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeImageModal();
            }
        });

        // Close modal with Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeImageModal();
            }
        });

        // ========== FUNÇÕES DO MODAL DE TAMANHOS ==========
        
        // Dados dos produtos com tamanhos
        const productSizes = {
            // Produtos com tamanho único
            'K93JAQUETAPUFFER2025': {
                name: 'Jaqueta Puffer Lava',
                price: 536.30,
                minQuantity: 6,
                sizes: [] // Tamanho único
            },
            'K93CROPPEDRAIZ2025': {
                name: 'Cropped Raiz Profunda',
                price: 141.90,
                minQuantity: 12,
                sizes: [] // Tamanho único
            },
            'K93BONEESSENTIAL2025': {
                name: 'Boné K93 Essential',
                price: 78.40,
                minQuantity: 12,
                sizes: [] // Tamanho único
            },
            
            // Produtos com 4 tamanhos (P, M, G, GG)
            'K93CAMISETABOXYKURA2025': {
                name: 'Camiseta Boxy Kura',
                price: 179.42,
                minQuantity: 12,
                sizes: ['P', 'M', 'G', 'GG']
            },
            'K93CAMISETABOXYEXPLOSAO2025': {
                name: 'Camiseta Boxy Explosão',
                price: 179.42,
                minQuantity: 12,
                sizes: ['P', 'M', 'G', 'GG']
            },
            'K93CAMISETABOXYMINHAFE2025': {
                name: 'Camiseta Boxy Minha Fé É Forte - 5 Cores',
                price: 139.84,
                minQuantity: 12,
                sizes: ['P', 'M', 'G', 'GG']
            },
            'K93CAMISETABOXYMAIS2025': {
                name: 'Camiseta Boxy Minha Mais Forte',
                price: 139.84,
                minQuantity: 12,
                sizes: ['P', 'M', 'G', 'GG']
            },
            
            // Produtos com 5 tamanhos (PP, P, M, G, GG)
            'K93CONJUNTOCINZAS2025': {
                name: 'Conjunto Cinzas',
                price: 174.20,
                minQuantity: 6,
                sizes: ['PP', 'P', 'M', 'G', 'GG']
            },
            'K93CONJUNTOCARBONO2025': {
                name: 'Conjunto Carbono',
                price: 174.20,
                minQuantity: 6,
                sizes: ['PP', 'P', 'M', 'G', 'GG']
            },
            
            // Produtos com 6 tamanhos (P, M, G, GG, XG, G1)
            'K93CAMISETASEXTA2025': {
                name: 'Camiseta de Sexta-Feira',
                price: 224.94,
                minQuantity: 12,
                sizes: ['P', 'M', 'G', 'GG', 'XG', 'G1']
            },
            'K93CAMISETASEGUNDA2025': {
                name: 'Camiseta de Segunda-Feira',
                price: 224.94,
                minQuantity: 12,
                sizes: ['P', 'M', 'G', 'GG', 'XG', 'G1']
            },
            'K93VESTIDONOITE2025': {
                name: 'Vestido Noite Ardente',
                price: 328.00,
                minQuantity: 6,
                sizes: ['P', 'M', 'G', 'GG', 'XG', 'G1']
            },
            'K93VESTIDOREGATAMARE2025': {
                name: 'Vestido Regata Esportiva Maré De Paz',
                price: 108.00,
                minQuantity: 6,
                sizes: ['P', 'M', 'G', 'GG', 'XG', 'G1']
            },
            'K93VESTIDOREGATAOURO2025': {
                name: 'Vestido Regata Esportiva Ouro Líquido',
                price: 108.00,
                minQuantity: 6,
                sizes: ['P', 'M', 'G', 'GG', 'XG', 'G1']
            },
            'K93VESTIDOCHAMAS2025': {
                name: 'Vestido Chamas',
                price: 127.20,
                minQuantity: 6,
                sizes: ['P', 'M', 'G', 'GG', 'XG', 'G1']
            },
            
            // Produtos com 7 tamanhos (P, M, G, GG, XG, G2, G3)
            'K93CAMISETAMOVIMENTOSOFF2025': {
                name: 'Camiseta MOVIMENTOS & ESTRUTURA off white',
                price: 173.63,
                minQuantity: 12,
                sizes: ['P', 'M', 'G', 'GG', 'XG', 'G2', 'G3']
            },
            'K93CAMISETAMOVIMENTOSPRETA2025': {
                name: 'Camiseta MOVIMENTOS & ESTRUTURA Preta',
                price: 173.63,
                minQuantity: 12,
                sizes: ['P', 'M', 'G', 'GG', 'XG', 'G2', 'G3']
            },
            'K93CAMISETACAFE2025': {
                name: 'Camiseta Café',
                price: 139.84,
                minQuantity: 12,
                sizes: ['P', 'M', 'G', 'GG', 'XG', 'G2', 'G3']
            },
            'K93CAMISETAACUCAR2025': {
                name: 'Camiseta Açucar',
                price: 139.84,
                minQuantity: 12,
                sizes: ['P', 'M', 'G', 'GG', 'XG', 'G2', 'G3']
            },
            'K93CASACOCORACAO2025': {
                name: 'Casaco de Moletom Canguru Kilombo 93 - Meu Coração',
                price: 244.76,
                minQuantity: 6,
                sizes: ['P', 'M', 'G', 'GG', 'XG', 'G2', 'G3']
            },
            'K93CAMISETAPADRONAGEM2025': {
                name: 'Camiseta PadronagemMonograma Realeza',
                price: 139.84,
                minQuantity: 12,
                sizes: ['P', 'M', 'G', 'GG', 'XG', 'G2', 'G3']
            },
            'K93CAMISETAKENDRICK2025': {
                name: 'Camiseta Kendrick Lamar - They Not Like Us',
                price: 139.84,
                minQuantity: 12,
                sizes: ['P', 'M', 'G', 'GG', 'XG', 'G2', 'G3']
            },
            'K93CAMISETAAFRIKAOURO2025': {
                name: 'Camiseta Afrika de Ouro',
                price: 139.84,
                minQuantity: 12,
                sizes: ['P', 'M', 'G', 'GG', 'XG', 'G2', 'G3']
            },
            'K93CORTAVENTO2025': {
                name: 'Corta-vento Padronagem',
                price: 244.76,
                minQuantity: 6,
                sizes: ['P', 'M', 'G', 'GG', 'XG', 'G2', 'G3']
            },
            'K93CASACOAMOR2025': {
                name: 'Casaco de Moletom Canguru Kilombo 93 - Amor Verdadeiro',
                price: 244.76,
                minQuantity: 6,
                sizes: ['P', 'M', 'G', 'GG', 'XG', 'G2', 'G3']
            },
            'K93CAMISETAESSENTIAL2025': {
                name: 'Camiseta K93 Essential',
                price: 104.88,
                minQuantity: 12,
                sizes: ['P', 'M', 'G', 'GG', 'XG', 'G2', 'G3']
            }
        };
        
        function openSizeModal(productId) {
            const productData = productSizes[productId];
            if (!productData) return;
            
            // Se o produto tem tamanho único (sizes vazio), não abre modal
            if (!productData.sizes || productData.sizes.length === 0) {
                return;
            }
            
            // Verificar se produto já está no carrinho
            const isInCart = cart.some(item => item.id.startsWith(productId));
            const buttonText = isInCart ? 'Atualizar' : 'Adicionar';
            
            const sizeInputs = productData.sizes.map(size => {
                // Carregar quantidades existentes se houver
                const existingQuantity = sizeSelections[productId] && sizeSelections[productId][size] ? sizeSelections[productId][size] : 0;
                
                return `
                    <div class="size-row" style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid #444;">
                        <span class="size-name" style="font-weight: 500; font-size: 1.1em; color: #fff;">${size}</span>
                        <div class="size-controls" style="display: flex; align-items: center; gap: 10px;">
                            <button class="size-btn" onclick="decreaseModalSize('${productId}', '${size}')" style="width: 35px; height: 35px; border: 2px solid #444; background: #3a3a3a; color: #fff; border-radius: 6px; cursor: pointer; font-size: 1.2em;">-</button>
                            <input type="number" class="size-input" id="modal-qty-${productId}-${size}" value="${existingQuantity}" min="0" onchange="updateModalSize('${productId}', '${size}', this.value)" style="width: 60px; height: 35px; text-align: center; border: 2px solid #444; border-radius: 6px; background: #1a1a1a; color: #fff;">
                            <button class="size-btn" onclick="increaseModalSize('${productId}', '${size}')" style="width: 35px; height: 35px; border: 2px solid #444; background: #3a3a3a; color: #fff; border-radius: 6px; cursor: pointer; font-size: 1.2em;">+</button>
                        </div>
                    </div>
                `;
            }).join('');
            
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.id = `size-modal-${productId}`;
            modal.style.cssText = 'position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: flex; justify-content: center; align-items: center; z-index: 1000;';
            
            modal.innerHTML = `
                <div class="modal-content" style="background: #2a2a2a; border-radius: 12px; padding: 25px; max-width: 500px; width: 90%; max-height: 80vh; overflow-y: auto; border: 2px solid #444;">
                    <div class="modal-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 class="modal-title" style="color: #4CAF50; margin: 0; font-size: 1.3em;">${productData.name}</h3>
                        <button class="close-btn" onclick="closeSizeModal('${productId}')" style="background: none; border: none; color: #ccc; font-size: 1.5em; cursor: pointer; padding: 5px;">&times;</button>
                    </div>
                    <div style="color: #ccc; margin-bottom: 20px; text-align: center;">
                        Selecione a quantidade desejada para cada tamanho:
                    </div>
                    <div style="margin-bottom: 20px;">
                        ${sizeInputs}
                    </div>
                    <div class="modal-total" id="modal-total-${productId}" style="font-weight: bold; text-align: center; margin: 20px 0; padding: 15px; background: #1a1a1a; border-radius: 8px;">
                        Total: 0 unidades
                    </div>
                    <div class="minimum-info" style="color: #ccc; font-size: 0.9em; text-align: center; margin-bottom: 15px;">
                        Mínimo: ${productData.minQuantity} unidades
                    </div>
                    <div class="modal-buttons" style="display: flex; gap: 15px;">
                        <button class="modal-btn cancel-btn" onclick="closeSizeModal('${productId}')" style="flex: 1; padding: 12px; border: none; border-radius: 8px; cursor: pointer; background: #666; color: #fff;">Cancelar</button>
                        <button class="modal-btn confirm-btn" id="confirm-btn-${productId}" onclick="confirmModalSizes('${productId}')" style="flex: 1; padding: 12px; border: none; border-radius: 8px; cursor: not-allowed; background: #666; color: #fff;">${buttonText}</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            updateModalTotal(productId);
        }
        
        function closeSizeModal(productId) {
            const modal = document.getElementById(`size-modal-${productId}`);
            if (modal) {
                modal.remove();
            }
        }
        
        function increaseModalSize(productId, size) {
            const input = document.getElementById(`modal-qty-${productId}-${size}`);
            let currentValue = parseInt(input.value) || 0;
            currentValue += 1;
            input.value = currentValue;
            updateModalSize(productId, size, currentValue);
        }
        
        function decreaseModalSize(productId, size) {
            const input = document.getElementById(`modal-qty-${productId}-${size}`);
            let currentValue = parseInt(input.value) || 0;
            
            if (currentValue > 0) {
                currentValue -= 1;
            }
            
            input.value = currentValue;
            updateModalSize(productId, size, currentValue);
        }
        
        function updateModalSize(productId, size, quantity) {
            quantity = Math.max(0, parseInt(quantity) || 0);
            updateModalTotal(productId);
        }
        
        function updateModalTotal(productId) {
            const productData = productSizes[productId];
            let total = 0;
            
            productData.sizes.forEach(size => {
                const input = document.getElementById(`modal-qty-${productId}-${size}`);
                if (input) {
                    total += parseInt(input.value) || 0;
                }
            });
            
            const totalDisplay = document.getElementById(`modal-total-${productId}`);
            const confirmBtn = document.getElementById(`confirm-btn-${productId}`);
            
            if (totalDisplay) {
                totalDisplay.textContent = `Total: ${total} unidades`;
            }
            
            // Habilitar/desabilitar botão baseado no mínimo
            if (confirmBtn) {
                if (total >= productData.minQuantity) {
                    confirmBtn.style.cssText = 'flex: 1; padding: 12px; border: none; border-radius: 8px; cursor: pointer; background: linear-gradient(135deg, #4CAF50, #45a049); color: #fff;';
                    confirmBtn.disabled = false;
                } else {
                    confirmBtn.style.cssText = 'flex: 1; padding: 12px; border: none; border-radius: 8px; cursor: not-allowed; background: #666; color: #fff;';
                    confirmBtn.disabled = true;
                }
            }
        }
        
        function confirmModalSizes(productId) {
            const productData = productSizes[productId];
            
            // Verificar se é uma atualização (produto já existe no carrinho)
            const isUpdate = sizeSelections[productId] && Object.keys(sizeSelections[productId]).length > 0;
            
            sizeSelections[productId] = {};
            
            productData.sizes.forEach(size => {
                const input = document.getElementById(`modal-qty-${productId}-${size}`);
                const quantity = parseInt(input.value) || 0;
                if (quantity > 0) {
                    sizeSelections[productId][size] = quantity;
                }
            });
            
            updateCartFromSizes(productId);
            updateSizesSummary(productId);
            
            // Mostrar mensagem de feedback
            const message = isUpdate ? "Pedido atualizado com sucesso" : "Itens adicionados ao seu pedido com sucesso";
            showFeedbackMessage(message);
            
            // Fechar modal após um breve delay para mostrar a mensagem
            setTimeout(() => {
                closeSizeModal(productId);
            }, 1500);
        }
        
        function showFeedbackMessage(message) {
            // Criar elemento de mensagem se não existir
            let feedbackElement = document.getElementById('feedback-message');
            if (!feedbackElement) {
                feedbackElement = document.createElement('div');
                feedbackElement.id = 'feedback-message';
                feedbackElement.style.cssText = `
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    background: #4CAF50;
                    color: white;
                    padding: 20px 30px;
                    border-radius: 8px;
                    font-size: 16px;
                    font-weight: bold;
                    z-index: 10001;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                    opacity: 0;
                    transition: opacity 0.3s ease;
                `;
                document.body.appendChild(feedbackElement);
            }
            
            // Mostrar mensagem
            feedbackElement.textContent = message;
            feedbackElement.style.opacity = '1';
            
            // Esconder mensagem após 1.2 segundos
            setTimeout(() => {
                feedbackElement.style.opacity = '0';
            }, 1200);
        }
        
        function updateSizesSummary(productId) {
            const summary = document.getElementById(`sizes-summary-${productId}`);
            const selections = sizeSelections[productId] || {};
            const total = Object.values(selections).reduce((sum, qty) => sum + qty, 0);
            
            if (total > 0) {
                const sizeList = Object.entries(selections)
                    .filter(([size, qty]) => qty > 0)
                    .map(([size, qty]) => `${size}: ${qty}`)
                    .join(', ');
                summary.textContent = `${total} unidades (${sizeList})`;
            } else {
                summary.textContent = 'Nenhum tamanho selecionado';
            }
        }
        
        function updateCartFromSizes(productId) {
            const productData = productSizes[productId];
            const selections = sizeSelections[productId] || {};
            
            // Remove itens existentes deste produto do carrinho
            cart = cart.filter(item => !item.id.startsWith(productId));
            
            // Adiciona novos itens baseados nas seleções
            Object.entries(selections).forEach(([size, quantity]) => {
                if (quantity > 0) {
                    const itemId = `${productId}-${size}`;
                    const itemName = `${productData.name} - ${size}`;
                    
                    cart.push({
                        id: itemId,
                        name: itemName,
                        price: productData.price,
                        quantity: quantity,
                        total: productData.price * quantity
                    });
                }
            });
            
            updateCartDisplay();
            updateOrderSummary();
            updateBenefitsAvailability();
            updateSubmitButton();
        }

        // Toggle theme
        function toggleTheme() {
            document.body.classList.toggle('light-theme');
            const themeIcon = document.querySelector('.theme-toggle i');
            const logoLight = document.getElementById('logo-light');
            const logoDark = document.getElementById('logo-dark');
            
            if (document.body.classList.contains('light-theme')) {
                themeIcon.className = 'fas fa-moon';
                logoLight.style.display = 'none';
                logoDark.style.display = 'block';
            } else {
                themeIcon.className = 'fas fa-sun';
                logoLight.style.display = 'block';
                logoDark.style.display = 'none';
            }
        }

        // Toggle cart modal
        function toggleCartModal() {
            // For now, just scroll to order summary
            document.querySelector('.order-summary').scrollIntoView({ behavior: 'smooth' });
        }

        // Generate order code
        function generateOrderCode() {
            const now = new Date();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const year = now.getFullYear();
            const randomNumbers = Math.floor(Math.random() * 100000).toString().padStart(5, '0');
            
            return `K93${randomNumbers}B2B${month}${year}`;
        }

        // Send data to Google Sheets
        async function sendToGoogleSheets(orderData) {
            const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxtca6BUqoVCZTZuQ3erEDtCwacpujVcLYHRxXJwP0gYsZ4R2JcgRWs4s0WmrLZARWV/exec';
            
            try {
                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(orderData)
                });
                
                return true;
            } catch (error) {
                console.error('Erro ao enviar para Google Sheets:', error);
                return false;
            }
        }

        // Form submission
        document.getElementById('orderForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            if (cartTotal < 7500) {
                alert('O valor mínimo do pedido é R$ 7.500,00');
                return;
            }
            
            // Generate order code
            const orderCode = generateOrderCode();
            const now = new Date();
            
            // Collect form data
            const companyData = {
                companyName: document.getElementById('company-name').value,
                cnpj: document.getElementById('cnpj').value,
                responsibleName: document.getElementById('responsible-name').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                city: document.getElementById('city').value,
                state: document.getElementById('state').value,
                storeCount: document.getElementById('store-count').value,
                sellersPerStore: document.getElementById('sellers-per-store').value,
                website: document.getElementById('website').value,
                instagram: document.getElementById('instagram').value,
                tiktok: document.getElementById('tiktok').value,
                paymentPreference: document.getElementById('payment-preference').value,
                comments: document.getElementById('comments').value
            };

            // Prepare data for Google Sheets (one row per product)
            const sheetsData = [];
            
            // Calcular totais para percentuais
            const totalQuantityAllProducts = cart.reduce((sum, item) => sum + item.quantity, 0);
            
            cart.forEach(item => {
                // Para produtos com tamanho, o ID é "PRODUTO-TAMANHO", então extraímos o ID original
                const originalProductId = item.id.includes('-') ? item.id.split('-')[0] : item.id;
                const product = products.find(p => p.id === originalProductId);
                
                if (product && item.quantity > 0) {
                    const productTotal = item.price * item.quantity;
                    const percentualUnidades = parseFloat(((item.quantity / totalQuantityAllProducts) * 100).toFixed(2));
                    const percentualValor = parseFloat(((productTotal / cartTotal) * 100).toFixed(2));
                    
                    // Calcular lucro estimado baseado no profit do produto
                    const lucroEstimado = product.profit * item.quantity;
                    
                    // Extrair tamanho se existir
                    const tamanho = item.id.includes('-') ? item.id.split('-')[1] : 'Tamanho único';
                    
                    // Obter texto da forma de pagamento
                    const paymentSelect = document.getElementById('payment-preference');
                    const paymentText = paymentSelect.options[paymentSelect.selectedIndex].text;
                    
                    sheetsData.push({
                        hora: now.toLocaleTimeString('pt-BR'),
                        data: now.toLocaleDateString('pt-BR'),
                        codigoPedido: orderCode,
                        nomeEmpresa: companyData.companyName,
                        cnpj: companyData.cnpj,
                        nomeResponsavel: companyData.responsibleName,
                        email: companyData.email,
                        telefone: companyData.phone,
                        cidade: companyData.city,
                        estado: companyData.state,
                        quantidadeLojas: companyData.storeCount,
                        vendedoresPorLoja: companyData.sellersPerStore,
                        website: companyData.website,
                        instagram: companyData.instagram,
                        tiktok: companyData.tiktok,
                        formaPagamento: paymentText,
                        nomeProduto: item.name,
                        sku: item.id,
                        tamanho: tamanho,
                        quantidadeSolicitada: item.quantity,
                        precoUnitario: item.price,
                        totalProduto: productTotal,
                        totalPedido: cartTotal,
                        lucroEstimado: lucroEstimado,
                        percentualUnidades: percentualUnidades,
                        percentualValor: percentualValor,
                        beneficiosEscolhidos: selectedBenefits.map(b => benefits.find(ben => ben.id === b)?.name).join(', '),
                        observacoes: companyData.comments
                    });
                }
            });
            
            // Show loading and update button
            const submitBtn = document.getElementById('submit-btn');
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Enviando...';
            submitBtn.disabled = true;
            
            // Send to Google Sheets
            const success = await sendToGoogleSheets(sheetsData);
            
            if (success) {
                // Show success message in button
                submitBtn.innerHTML = `<i class="fas fa-check"></i> Pedido enviado com sucesso! O seu código para acompanhamento é ${orderCode}.`;
                submitBtn.style.background = 'linear-gradient(135deg, var(--success-color), var(--secondary-green))';
                
                // Reset form after successful submission
                setTimeout(() => {
                    if (confirm('Pedido enviado! Caso precise falar conosco, clique no botão do WhatsApp, mas caso já tenha finalizado, pode fechar essa janela. Agradecemos!')) {
                        location.reload();
                    }
                }, 5000);
            } else {
                // Show error and restore button
                submitBtn.innerHTML = '<i class="fas fa-exclamation-triangle"></i> Erro ao enviar. Tente novamente.';
                submitBtn.style.background = 'var(--error-color)';
                setTimeout(() => {
                    submitBtn.innerHTML = '<i class="fas fa-paper-plane"></i> Enviar Pedido';
                    submitBtn.style.background = 'linear-gradient(135deg, var(--primary-green), var(--secondary-green))';
                    submitBtn.disabled = false;
                }, 3000);
            }
        });

        // Banco de dados de cidades por estado
        const citiesByState = {
            'AC': ['Rio Branco', 'Cruzeiro do Sul', 'Sena Madureira', 'Tarauacá', 'Feijó', 'Brasileia', 'Plácido de Castro', 'Xapuri', 'Senador Guiomard', 'Epitaciolândia'],
            'AL': ['Maceió', 'Arapiraca', 'Palmeira dos Índios', 'Rio Largo', 'Penedo', 'União dos Palmares', 'São Miguel dos Campos', 'Santana do Ipanema', 'Delmiro Gouveia', 'Coruripe'],
            'AP': ['Macapá', 'Santana', 'Laranjal do Jari', 'Oiapoque', 'Mazagão', 'Porto Grande', 'Tartarugalzinho', 'Vitória do Jari', 'Ferreira Gomes', 'Pracuúba'],
            'AM': ['Manaus', 'Parintins', 'Itacoatiara', 'Manacapuru', 'Coari', 'Tefé', 'Tabatinga', 'Maués', 'São Gabriel da Cachoeira', 'Humaitá'],
            'BA': ['Salvador', 'Feira de Santana', 'Vitória da Conquista', 'Camaçari', 'Juazeiro', 'Ilhéus', 'Itabuna', 'Lauro de Freitas', 'Jequié', 'Teixeira de Freitas'],
            'CE': ['Fortaleza', 'Caucaia', 'Juazeiro do Norte', 'Maracanaú', 'Sobral', 'Crato', 'Itapipoca', 'Maranguape', 'Iguatu', 'Quixadá'],
            'DF': ['Brasília', 'Gama', 'Taguatinga', 'Ceilândia', 'Sobradinho', 'Planaltina', 'Paranoá', 'Núcleo Bandeirante', 'Riacho Fundo', 'Samambaia'],
            'ES': ['Vitória', 'Vila Velha', 'Cariacica', 'Serra', 'Cachoeiro de Itapemirim', 'Linhares', 'São Mateus', 'Colatina', 'Guarapari', 'Aracruz'],
            'GO': ['Goiânia', 'Aparecida de Goiânia', 'Anápolis', 'Rio Verde', 'Luziânia', 'Águas Lindas de Goiás', 'Valparaíso de Goiás', 'Trindade', 'Formosa', 'Novo Gama'],
            'MA': ['São Luís', 'Imperatriz', 'São José de Ribamar', 'Timon', 'Caxias', 'Codó', 'Paço do Lumiar', 'Açailândia', 'Bacabal', 'Balsas'],
            'MT': ['Cuiabá', 'Várzea Grande', 'Rondonópolis', 'Sinop', 'Tangará da Serra', 'Cáceres', 'Sorriso', 'Lucas do Rio Verde', 'Barra do Garças', 'Primavera do Leste'],
            'MS': ['Campo Grande', 'Dourados', 'Três Lagoas', 'Corumbá', 'Ponta Porã', 'Naviraí', 'Nova Andradina', 'Sidrolândia', 'Maracaju', 'São Gabriel do Oeste'],
            'MG': ['Belo Horizonte', 'Uberlândia', 'Contagem', 'Juiz de Fora', 'Betim', 'Montes Claros', 'Ribeirão das Neves', 'Uberaba', 'Governador Valadares', 'Ipatinga'],
            'PA': ['Belém', 'Ananindeua', 'Santarém', 'Marabá', 'Parauapebas', 'Castanhal', 'Abaetetuba', 'Cametá', 'Bragança', 'Marituba'],
            'PB': ['João Pessoa', 'Campina Grande', 'Santa Rita', 'Patos', 'Bayeux', 'Sousa', 'Cajazeiras', 'Cabedelo', 'Guarabira', 'Mamanguape'],
            'PR': ['Curitiba', 'Londrina', 'Maringá', 'Ponta Grossa', 'Cascavel', 'São José dos Pinhais', 'Foz do Iguaçu', 'Colombo', 'Guarapuava', 'Paranaguá'],
            'PE': ['Recife', 'Jaboatão dos Guararapes', 'Olinda', 'Caruaru', 'Petrolina', 'Paulista', 'Cabo de Santo Agostinho', 'Camaragibe', 'Garanhuns', 'Vitória de Santo Antão'],
            'PI': ['Teresina', 'Parnaíba', 'Picos', 'Piripiri', 'Floriano', 'Campo Maior', 'Barras', 'União', 'Altos', 'Pedro II'],
            'RJ': ['Rio de Janeiro', 'São Gonçalo', 'Duque de Caxias', 'Nova Iguaçu', 'Niterói', 'Belford Roxo', 'São João de Meriti', 'Campos dos Goytacazes', 'Petrópolis', 'Volta Redonda'],
            'RN': ['Natal', 'Mossoró', 'Parnamirim', 'São Gonçalo do Amarante', 'Macaíba', 'Ceará-Mirim', 'Caicó', 'Assu', 'Currais Novos', 'Nova Cruz'],
            'RS': ['Porto Alegre', 'Caxias do Sul', 'Pelotas', 'Canoas', 'Santa Maria', 'Gravataí', 'Viamão', 'Novo Hamburgo', 'São Leopoldo', 'Rio Grande'],
            'RO': ['Porto Velho', 'Ji-Paraná', 'Ariquemes', 'Vilhena', 'Cacoal', 'Rolim de Moura', 'Guajará-Mirim', 'Jaru', 'Ouro Preto do Oeste', 'Machadinho d\'Oeste'],
            'RR': ['Boa Vista', 'Rorainópolis', 'Caracaraí', 'Alto Alegre', 'Mucajaí', 'Bonfim', 'Cantá', 'Normandia', 'Pacaraima', 'Iracema'],
            'SC': ['Florianópolis', 'Joinville', 'Blumenau', 'São José', 'Criciúma', 'Chapecó', 'Itajaí', 'Lages', 'Jaraguá do Sul', 'Palhoça'],
            'SP': ['São Paulo', 'Guarulhos', 'Campinas', 'São Bernardo do Campo', 'Santo André', 'Osasco', 'Ribeirão Preto', 'Sorocaba', 'Mauá', 'São José dos Campos'],
            'SE': ['Aracaju', 'Nossa Senhora do Socorro', 'Lagarto', 'Itabaiana', 'São Cristóvão', 'Estância', 'Tobias Barreto', 'Simão Dias', 'Propriá', 'Canindé de São Francisco'],
            'TO': ['Palmas', 'Araguaína', 'Gurupi', 'Porto Nacional', 'Paraíso do Tocantins', 'Colinas do Tocantins', 'Guaraí', 'Tocantinópolis', 'Miracema do Tocantins', 'Dianópolis']
        };

        // Função para atualizar as cidades baseado no estado selecionado
        function updateCities() {
            const stateSelect = document.getElementById('state');
            const citySelect = document.getElementById('city');
            const selectedState = stateSelect.value;
            
            // Limpar opções de cidade
            citySelect.innerHTML = '';
            
            if (selectedState === '') {
                citySelect.disabled = true;
                citySelect.innerHTML = '<option value="">Primeiro selecione o estado</option>';
                return;
            }
            
            // Habilitar o select de cidade
            citySelect.disabled = false;
            
            // Adicionar opção padrão
            citySelect.innerHTML = '<option value="">Selecione a cidade</option>';
            
            // Adicionar cidades do estado selecionado
            const cities = citiesByState[selectedState] || [];
            cities.forEach(city => {
                const option = document.createElement('option');
                option.value = city;
                option.textContent = city;
                citySelect.appendChild(option);
            });
        }
    </script>
</body>
</html>

